---
alwaysApply: true
---

# Multilingual Content Management

서비스의 이용자는 주로 베트남, 미국, 한국에 거주하며, 모든 사용자에게 보여지는 컨텐츠는 다국어로 관리되어야 합니다.

## Supported Languages
- **한국어 (Korean)**: `ko` 또는 `ko-KR`
- **영어 (English)**: `en` 또는 `en-US`
- **베트남어 (Vietnamese)**: `vi` 또는 `vi`

## Multilingual Content Types
다음과 같은 컨텐츠는 반드시 다국어로 등록해야 합니다:
- **페이지 제목 (Page Titles)**: 모든 페이지의 제목
- **페이지 설명 (Page Descriptions)**: 페이지 제목 아래에 표시되는 설명
- **고정된 문구 (Fixed Text)**: 버튼 텍스트, 라벨, 플레이스홀더 등 모든 고정된 문구
- 기타 모든 사용자에게 노출되는 컨텐츠

## Data Structure Pattern
다국어 컨텐츠는 다음과 같은 구조로 관리해야 합니다:

```typescript
interface MultilingualContent {
  ko: string;  // 한국어
  en: string;  // 영어
  vi: string;  // 베트남어
}

// 예시: 공지사항
interface Announcement {
  id: string;
  title: MultilingualContent;
  content: MultilingualContent;
  createdAt: string;
  updatedAt: string;
}

// 예시: 이메일 템플릿
interface EmailTemplate {
  id: string;
  groupId: string;
  name: MultilingualContent;  // 템플릿 이름
  title: MultilingualContent;  // 이메일 제목
  description?: MultilingualContent;  // 템플릿 설명
  content: MultilingualContent;  // HTML content
  variables?: string[];
}

// 예시: 템플릿 그룹
interface MailGroup {
  id: string;
  name: MultilingualContent;  // 그룹 이름
  templates: MailTemplate[];
}
```

## UI Implementation Pattern
다국어 입력을 위한 UI는 탭 기반 인터페이스를 사용합니다:

```typescript
import { useLanguage } from '../context/LanguageContext';

const { language } = useLanguage();

// 언어에 따라 탭 인덱스 매핑: ko -> 0, en -> 1, vi -> 2
const getLanguageTabIndex = (lang: 'ko' | 'en' | 'vi'): number => {
  switch (lang) {
    case 'ko':
      return 0;
    case 'en':
      return 1;
    case 'vi':
      return 2;
    default:
      return 0;
  }
};

const [languageTab, setLanguageTab] = useState<number>(getLanguageTabIndex(language));
const [content, setContent] = useState<MultilingualContent>({
  ko: '',
  en: '',
  vi: '',
});

const prevLanguageRef = useRef<'ko' | 'en' | 'vi'>(language);

// GNB에서 언어가 변경되면 탭도 자동으로 변경
useEffect(() => {
  if (prevLanguageRef.current !== language) {
    setLanguageTab(getLanguageTabIndex(language));
    prevLanguageRef.current = language;
  }
}, [language]);

// 탭 전환 핸들러
const handleLanguageTabChange = (event: React.SyntheticEvent, newValue: number) => {
  setLanguageTab(newValue);
};

// 언어별 컨텐츠 업데이트
const handleContentChange = (language: 'ko' | 'en' | 'vi', value: string) => {
  setContent((prev) => ({
    ...prev,
    [language]: value,
  }));
};

// UI 구조
<Tabs value={languageTab} onChange={handleLanguageTabChange}>
  {/* 탭 라벨 (다국어 적용 필요) */}
  <Tab label="한국어" />
  <Tab label="English" />
  <Tab label="Tiếng Việt" />
</Tabs>
<CustomTabPanel value={languageTab} index={0}>
  {/* 한국어 입력 필드 */}
  <TextField
    value={content.ko}
    onChange={(e) => handleContentChange('ko', e.target.value)}
    label="제목 (한국어)"  {/* 라벨 (다국어 적용 필요) */}
    fullWidth
  />
</CustomTabPanel>
<CustomTabPanel value={languageTab} index={1}>
  {/* 영어 입력 필드 */}
  <TextField
    value={content.en}
    onChange={(e) => handleContentChange('en', e.target.value)}
    label="Title (English)"  {/* 라벨 (다국어 적용 필요) */}
    fullWidth
  />
</CustomTabPanel>
<CustomTabPanel value={languageTab} index={2}>
  {/* 베트남어 입력 필드 */}
  <TextField
    value={content.vi}
    onChange={(e) => handleContentChange('vi', e.target.value)}
    label="Tiêu đề (Tiếng Việt)"  {/* 라벨 (다국어 적용 필요) */}
    fullWidth
  />
</CustomTabPanel>
```

## Language-Aware Tab Selection
GNB(Global Navigation Bar)에서 설정한 언어에 따라 다국어 입력 탭이 자동으로 선택되어야 합니다.

- **자동 탭 선택**: GNB에서 언어를 변경하면 해당 언어의 탭이 자동으로 활성화됩니다
- **언어-탭 매핑**: `ko` → 0 (한국어 탭), `en` → 1 (English 탭), `vi` → 2 (Tiếng Việt 탭)
- **실시간 동기화**: `useLanguage` 훅을 통해 현재 언어를 가져오고, 언어 변경 시 `useEffect`로 탭을 자동 전환합니다
- **사용자 수동 선택 가능**: 자동 선택 기능과 함께 사용자가 직접 탭을 선택할 수도 있습니다

## Validation Rules
- **필수 입력**: 모든 언어에 대한 컨텐츠 입력이 필수입니다
- **빈 값 검증**: 저장 시 각 언어별로 빈 값이 있는지 확인해야 합니다
- **HTML 컨텐츠**: 이메일 템플릿의 경우 HTML 컨텐츠도 각 언어별로 관리됩니다

```typescript
const validateMultilingualContent = (content: MultilingualContent): boolean => {
  return content.ko.trim() !== '' && content.en.trim() !== '' && content.vi.trim() !== '';
};

const handleSave = () => {
  if (!validateMultilingualContent(content)) {
    // 안내 메시지 (다국어 적용 필요)
    showSnackbar('모든 언어에 대한 컨텐츠를 입력해주세요.', 'error');
    return;
  }
  // 저장 로직
};
```

## Rich Text Editor (TinyMCE) Integration
이메일 템플릿 등 HTML 컨텐츠가 필요한 경우, 각 언어별로 독립적인 TinyMCE 에디터를 사용합니다:

```typescript
const [editorRefs, setEditorRefs] = useState<{
  ko: Editor | null;
  en: Editor | null;
  vi: Editor | null;
}>({
  ko: null,
  en: null,
  vi: null,
});

// 언어별 에디터 초기화
const handleEditorInit = (language: 'ko' | 'en' | 'vi', editor: Editor) => {
  setEditorRefs((prev) => ({
    ...prev,
    [language]: editor,
  }));
};

// 언어별 컨텐츠 가져오기
const getContent = (): MultilingualContent => {
  return {
    ko: editorRefs.ko?.getContent() || '',
    en: editorRefs.en?.getContent() || '',
    vi: editorRefs.vi?.getContent() || '',
  };
};

// UI 구조
<CustomTabPanel value={languageTab} index={0}>
  <Editor
    onInit={(evt, editor) => handleEditorInit('ko', editor)}
    initialValue={content.ko}
    init={{
      ...editorConfig,
      language: 'ko-KR', // 한국어: ko-KR 형식 사용
    }}
  />
</CustomTabPanel>
<CustomTabPanel value={languageTab} index={1}>
  <Editor
    onInit={(evt, editor) => handleEditorInit('en', editor)}
    initialValue={content.en}
    init={{
      ...editorConfig,
      language: 'en', // 영어: en 사용
    }}
  />
</CustomTabPanel>
<CustomTabPanel value={languageTab} index={2}>
  <Editor
    onInit={(evt, editor) => handleEditorInit('vi', editor)}
    initialValue={content.vi}
    init={{
      ...editorConfig,
      language: 'vi', // 베트남어: vi만 사용 (vi-VN 아님)
    }}
  />
</CustomTabPanel>
```

**TinyMCE Language Configuration:**
- **한국어**: 반드시 `'ko-KR'` 형식을 사용합니다 (`'ko'`만 사용하거나 `'ko_KR'` 형식은 절대 사용하지 않습니다)
- **영어**: `'en'`을 사용합니다
- **베트남어**: 반드시 `'vi'`만 사용합니다 (`'vi-VN'` 또는 `'vi_VN'` 형식은 절대 사용하지 않습니다)
- **공식 언어 코드만 사용**: TinyMCE 공식 언어 코드 목록에 정의된 형식만 사용해야 합니다
- 탭을 변경할 때 에디터가 재생성되어야 언어가 올바르게 적용됩니다. 이를 위해 `key` prop에 탭 인덱스를 포함시키거나, 활성 탭에서만 에디터를 렌더링하도록 구현해야 합니다

## Storage Pattern
다국어 컨텐츠는 다음과 같은 형식으로 저장됩니다:

```typescript
// LocalStorage 예시
interface StoredTemplate {
  groupId: string;
  templateId: string;
  title: {
    ko: string;
    en: string;
    vi: string;
  };
  content: {
    ko: string;
    en: string;
    vi: string;
  };
}

// API 요청/응답 예시
interface APIRequest {
  title: MultilingualContent;
  content: MultilingualContent;
}

interface APIResponse {
  id: string;
  title: MultilingualContent;
  content: MultilingualContent;
  createdAt: string;
}
```

## Page Titles and Fixed Text
모든 페이지의 제목, 설명, 그리고 고정된 문구들도 다국어로 관리되어야 합니다.

### Page Text Management
- **페이지 제목**: 모든 페이지의 제목은 다국어로 관리됩니다
- **페이지 설명**: 페이지 제목 아래에 표시되는 설명도 다국어로 관리됩니다
- **고정된 문구**: 버튼 텍스트, 라벨, 플레이스홀더 등 모든 고정된 문구도 다국어로 관리됩니다

### Implementation Pattern
페이지 제목과 설명은 `src/utils/pageTexts.ts` 파일에서 중앙 관리합니다:

```typescript
// src/utils/pageTexts.ts
import { MultilingualContent } from '../types/multilingual';

export interface PageTexts {
  title: MultilingualContent;
  description?: MultilingualContent;
}

export const pageTexts: Record<string, PageTexts> = {
  autoMail: {
    // 페이지 제목 (다국어)
    title: {
      ko: '자동 메일',
      en: 'Auto Mail',
      vi: 'Email tự động',
    },
    // 페이지 설명 (다국어)
    description: {
      ko: '사용자에게 자동으로 발송되는 이메일 템플릿 목록입니다.',
      en: 'List of email templates that are automatically sent to users.',
      vi: 'Danh sách các mẫu email được gửi tự động cho người dùng.',
    },
  },
  // ... 다른 페이지들
};

export const getPageText = (pageKey: string, language: 'ko' | 'en' | 'vi'): { title: string; description?: string } => {
  const pageText = pageTexts[pageKey];
  if (!pageText) {
    return { title: pageKey };
  }

  return {
    title: pageText.title[language],
    description: pageText.description?.[language],
  };
};
```

### Usage in Pages
페이지 컴포넌트에서 다음과 같이 사용합니다:

```typescript
import { useLanguage } from '../context/LanguageContext';
import { getPageText, getCommonText } from '../utils/pageTexts';

const MyPage = () => {
  const { language } = useLanguage();
  const pageText = getPageText('myPage', language);

  return (
    <Box>
      {/* 페이지 제목 (다국어) */}
      <Typography variant="h4" gutterBottom>
        {pageText.title}
      </Typography>
      {/* 페이지 설명 (다국어) */}
      {pageText.description && (
        <Typography variant="subtitle1" color="text.secondary">
          {pageText.description}
        </Typography>
      )}
      {/* 버튼 텍스트 (다국어 적용 필요) */}
      <Button variant="contained">
        {getCommonText('save', language)}  {/* 저장 */}
      </Button>
      <Button variant="outlined">
        {getCommonText('cancel', language)}  {/* 취소 */}
      </Button>
      <Button variant="outlined" color="error">
        {getCommonText('delete', language)}  {/* 삭제 */}
      </Button>
      {/* 페이지 내용 */}
    </Box>
  );
};
```

### Data Structure for Multilingual Content
더미데이터의 모든 텍스트 필드도 다국어로 관리됩니다:

```typescript
// 예시: MailTemplate 인터페이스
export interface MailTemplate {
  id: number | string;
  name: MultilingualContent;  // 템플릿 이름
  title?: MultilingualContent;  // 이메일 제목
  description?: MultilingualContent;  // 템플릿 설명
}

// 예시: MailGroup 인터페이스
export interface MailGroup {
  id: string;
  name: MultilingualContent;  // 그룹 이름
  templates: MailTemplate[];
}
```

### Displaying Multilingual Content
다국어 컨텐츠를 표시할 때는 현재 언어에 맞게 표시해야 합니다:

```typescript
import { useLanguage } from '../context/LanguageContext';
import { getCommonText } from '../utils/pageTexts';

const MyComponent = () => {
  const { language } = useLanguage();

  return (
    <Box>
      {/* 템플릿 이름 표시 (다국어) */}
    <Typography>
      {typeof content.name === 'string'
        ? content.name
        : content.name[language]
      }
    </Typography>

      {/* 버튼 텍스트 (다국어 적용 필요) */}
      <Button variant="contained">
        {getCommonText('save', language)}  {/* 저장 */}
      </Button>
      <Button variant="outlined">
        {getCommonText('edit', language)}  {/* 수정 */}
      </Button>
      <Button variant="outlined" color="error">
        {getCommonText('delete', language)}  {/* 삭제 */}
      </Button>

      {/* 라벨 (다국어 적용 필요) */}
      <TextField
        label={getCommonText('emailAddress', language)}  {/* 이메일 주소 */}
        placeholder={getCommonText('emailAddress', language)}  {/* 플레이스홀더 (다국어 적용 필요) */}
        fullWidth
      />

      {/* 안내 메시지 (다국어 적용 필요) */}
      <Alert severity="info">
        {getCommonText('noRecipientsSelected', language)}  {/* 발송 대상이 선택되지 않았습니다. */}
      </Alert>
    </Box>
  );
};
```

### Backward Compatibility
기존 단일 문자열 형식의 데이터를 다국어로 마이그레이션할 때는 하위 호환성을 고려해야 합니다:

```typescript
// 하위 호환성: 단일 문자열을 MultilingualContent로 변환
const migrateContent = (content: string | MultilingualContent): MultilingualContent => {
  if (typeof content === 'string') {
    return {
      ko: content,
      en: content,
      vi: content,
    };
  }
  return content;
};
```

### Mock Data Guidelines
더미데이터를 작성할 때는 모든 텍스트 필드를 다국어로 작성해야 합니다:

```typescript
// 예시: 자동 메일 그룹 더미데이터
export const autoMailGroups: MailGroup[] = [
  {
    id: 'member',
    // 그룹 이름 (다국어)
    name: {
      ko: '회원',
      en: 'Member',
      vi: 'Thành viên',
    },
    templates: [
      {
        id: 1,
        // 템플릿 이름 (다국어)
        name: {
          ko: '가입 환영',
          en: 'Welcome',
          vi: 'Chào mừng',
        },
        // 이메일 제목 (다국어)
        title: {
          ko: '도토리에 오신 것을 환영합니다!',
          en: 'Welcome to Dotore!',
          vi: 'Chào mừng đến với Dotore!',
        },
        // 템플릿 설명 (다국어)
        description: {
          ko: '신규 회원 가입 시 자동으로 발송되는 환영 메일',
          en: 'Welcome email automatically sent when a new member joins',
          vi: 'Email chào mừng được gửi tự động khi thành viên mới tham gia',
        },
      },
      // ... 다른 템플릿들
    ],
  },
  // ... 다른 그룹들
];
```

**더미데이터 작성 규칙:**
- 모든 텍스트 필드는 `MultilingualContent` 타입으로 작성
- 한국어, 영어, 베트남어 모두 필수 입력
- 의미가 동일하도록 각 언어별로 적절히 번역
- 일관된 구조 유지

### Key Points
- **페이지 제목/설명**: `pageTexts.ts`에서 중앙 관리
- **더미데이터**: 모든 텍스트 필드를 `MultilingualContent` 타입으로 변경
- **표시 로직**: 현재 언어에 맞게 표시 (하위 호환성 고려)
- **하위 호환성**: 기존 단일 문자열 데이터를 자동으로 다국어로 변환
- **일관성**: 모든 더미데이터는 동일한 다국어 구조를 따름

## Key Points
- **필수 다국어 지원**: 모든 사용자 노출 컨텐츠는 3개 언어(한국어, 영어, 베트남어) 모두 필수
- **탭 기반 UI**: 언어별 입력을 위해 탭 인터페이스 사용
- **GNB 언어 연동**: GNB에서 설정한 언어에 따라 해당 언어 탭이 자동으로 선택됨
- **독립적인 에디터**: HTML 컨텐츠의 경우 각 언어별로 독립적인 에디터 인스턴스 사용
- **검증 필수**: 저장 전 모든 언어에 대한 컨텐츠 입력 검증
- **일관된 구조**: 모든 다국어 컨텐츠는 동일한 `MultilingualContent` 타입 사용
- **페이지 제목/설명**: 모든 페이지의 제목과 설명도 다국어로 관리
- **고정된 문구**: 버튼, 라벨, 플레이스홀더 등 모든 고정된 문구도 다국어로 관리

## Summary
- **지원 언어**: 한국어(ko), 영어(en), 베트남어(vi)
- **적용 대상**:
  - 공지사항, 이벤트, 이메일 템플릿 등 모든 사용자 노출 컨텐츠
  - 페이지 제목, 페이지 설명
  - 템플릿 그룹 이름, 템플릿 이름, 이메일 제목, 템플릿 설명
  - 버튼 텍스트, 라벨, 플레이스홀더 등 모든 고정된 문구
- **데이터 구조**: `MultilingualContent` 인터페이스로 통일
- **UI 패턴**: 탭 기반 인터페이스로 언어별 입력
- **GNB 연동**: GNB 언어 설정에 따라 탭 자동 선택 및 모든 텍스트 자동 변경
- **검증**: 저장 전 모든 언어 입력 필수 검증
- **에디터**: HTML 컨텐츠는 언어별 독립적인 에디터 인스턴스 사용
- **페이지 텍스트**: `pageTexts.ts`에서 중앙 관리
- **하위 호환성**: 기존 단일 문자열 데이터를 자동으로 다국어로 변환
